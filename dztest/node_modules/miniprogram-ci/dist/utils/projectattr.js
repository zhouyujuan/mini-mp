"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getProjectAttr=void 0;const request_1=require("./request"),sign_1=require("./sign"),log=require("./log"),config_1=require("../config"),url_config_1=require("./url_config"),jsonParse_1=require("./jsonParse"),testCache={};async function getProjectAttr(e,r){try{if(global.useAttrCache&&testCache[r])return testCache[r];const t=await sign_1.getSignature(e,r),{body:o}=await request_1.request({url:url_config_1.GET_ATTR_URL,method:"post",body:JSON.stringify({appid:r,signature:t}),headers:{"content-type":"application/json"}}),s=jsonParse_1.jsonRespParse(o,url_config_1.GET_ATTR_URL);if(0===s.errCode)return global.useAttrCache&&(testCache[r]=s.data),s.data;log.error(`get ${r} project attr fail errCode: ${s.errCode}, errMsg: ${s.errMsg}`)}catch(e){log.error(`get ${r} project attr fail ${e}`)}return config_1.DefaultProjectAttr}exports.getProjectAttr=getProjectAttr;