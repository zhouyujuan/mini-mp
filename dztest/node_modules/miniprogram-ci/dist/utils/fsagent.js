"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FSAgent=void 0;const fs=require("fs"),log=require("./log"),tools_1=require("./tools");class FSAgent{constructor(e){e&&(this._agent=e)}setAgent(e){this._agent=e}stat(e){return e=tools_1.normalizePath(e),this._agent&&this._agent.stat?(log.debug("FSAgent use agent.stat for "+e),this._agent.stat(e)):new Promise((t,s)=>{log.debug("FSAgent use fs.stat for "+e),fs.stat(e,(e,r)=>{if(e)return s(e);t(r)})})}exists(e){return e=tools_1.normalizePath(e),this._agent&&this._agent.exists?(log.debug("FSAgent use agent.exists for "+e),this._agent.exists(e)):new Promise((t,s)=>{log.debug("FSAgent use fs.exists for "+e),fs.exists(e,e=>{t(e)})})}readFile(e){return e=tools_1.normalizePath(e),this._agent&&this._agent.readFile?(log.debug("FSAgent use agent.readFile for "+e),this._agent.readFile(e)):new Promise((t,s)=>{log.debug("FSAgent use fs.readFile for "+e),fs.readFile(e,null,(e,r)=>{if(e)return s(e);t(r)})})}writeFile(e,t,s=null){return e=tools_1.normalizePath(e),this._agent&&this._agent.writeFile?(log.debug("FSAgent use agent.writeFile for "+e),this._agent.writeFile(e,t,s)):new Promise((r,i)=>{log.debug("FSAgent use fs.writeFile for "+e),fs.writeFile(e,t,s,e=>{if(e)return i(e);r()})})}readdir(e){return e=tools_1.normalizePath(e),this._agent&&this._agent.readdir?(log.debug("FSAgent use agent.readdir for "+e),this._agent.readdir(e)):new Promise((t,s)=>{fs.readdir(e,(e,r)=>{if(e)return s(e);t(r)})})}}exports.FSAgent=FSAgent;