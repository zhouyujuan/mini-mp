"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.abortTask=exports.runTask=void 0;const tslib_1=require("tslib"),worker_manager_1=require("./worker_manager"),childprocess_manager_1=require("./childprocess_manager"),processTask=require("./task/index"),log=require("../utils/log");tslib_1.__exportStar(require("./config"),exports);const isDevtools=void 0!==process.env.__nwjs;async function runTask(r,e,s=(()=>{})){try{if(process.__nwjs&&"wechatwebdevtools"===nw.App.manifest.appname)return await childprocess_manager_1.childProcessManager.runTask(r,e,s);const a=worker_manager_1.getWorkerManager(isDevtools);return await a.runTask(r,e,s)}catch(s){if(s===worker_manager_1.AbortEvent)throw s;return log.error("runTask catch error "+s),processTask(r,e)}}function abortTask(r){worker_manager_1.getWorkerManager(isDevtools).abort(r)}exports.runTask=runTask,exports.abortTask=abortTask;