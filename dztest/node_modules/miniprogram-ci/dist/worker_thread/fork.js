"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const processTask=require("./task/index"),config_1=require("./config"),log=require("../utils/log");let isbusy=!1;process.on("message",s=>{const{command:e,data:o}=s;e===config_1.COMMAND.RUN_TASK&&(isbusy=!0,processTask(o.taskName,o.data).then(s=>{isbusy=!1,process.send({command:config_1.COMMAND.TASK_DONE,data:s})}).catch(s=>{isbusy=!1,process.send({command:config_1.COMMAND.TASK_DONE,data:{error:s.toString()}})}))}),process.on("SIGTERM",()=>{isbusy&&(log.error("forked sub process is kill when busy"),process.exit(1)),process.exit(0)});